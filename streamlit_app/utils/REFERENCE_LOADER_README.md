# Reference Loader Module

## üìö –û–ø–∏—Å–∞–Ω–∏–µ

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ JSON-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ê–≥—Ä–æ–î–∞–Ω–Ω—ã–µ –ö–ó.

–†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø—É—Ç–µ–π –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Streamlit –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–†–æ–±–∞—Å—Ç–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Ñ–∞–π–ª—ã –≤ 8+ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—É—Ç—è—Ö
- ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –∫–µ—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ **–ü–æ–Ω—è—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø—É—Ç–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
- ‚úÖ **–ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –≥–æ—Ç–æ–≤—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ **–¢–∏–ø–∏–∑–∞—Ü–∏—è** - –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ type hints

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from utils.reference_loader import load_fertilizers, load_crops

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
fertilizers = load_fertilizers()
crops = load_crops()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
for category, items in fertilizers.items():
    print(f"–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {category}")
    for name, details in items.items():
        print(f"  - {name}: N={details['N']}%, P={details['P']}%, K={details['K']}%")
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Streamlit —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö

**–î–æ:**
```python
# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± - –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã–π
def load_fertilizers_reference():
    reference_path = Path(__file__).parent.parent / "data" / "fertilizers.json"
    try:
        with open(reference_path, "r", encoding="utf-8") as f:
            return json.load(f)
    except FileNotFoundError:
        st.error("–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É–¥–æ–±—Ä–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return {}

fertilizers_ref = load_fertilizers_reference()
```

**–ü–æ—Å–ª–µ:**
```python
# –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± - —Ä–æ–±–∞—Å—Ç–Ω—ã–π
from utils.reference_loader import load_fertilizers, load_tractors

fertilizers_ref = load_fertilizers()
tractors_ref = load_tractors()
```

---

## üìñ API Reference

### –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è

#### `load_reference(filename: str, show_error: bool = True) -> Dict[str, Any]`

–ó–∞–≥—Ä—É–∑–∫–∞ –ª—é–±–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –ø–æ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `filename` (str) - –∏–º—è JSON —Ñ–∞–π–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "fertilizers.json")
- `show_error` (bool) - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ –æ—à–∏–±–∫—É –≤ Streamlit –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- Dict[str, Any] - –¥–∞–Ω–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ –∏–ª–∏ –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å –ø—Ä–∏ –æ—à–∏–±–∫–µ

**–ü—Ä–∏–º–µ—Ä:**
```python
from utils.reference_loader import load_reference

# –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
custom_data = load_reference("my_custom_reference.json")

# –ë–µ–∑ –ø–æ–∫–∞–∑–∞ –æ—à–∏–±–æ–∫ (–¥–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤)
optional_data = load_reference("optional.json", show_error=False)
```

---

### –ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∏

#### –ê–≥—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

```python
from utils.reference_loader import (
    load_crops,        # –ö—É–ª—å—Ç—É—Ä—ã
    load_fertilizers,  # –£–¥–æ–±—Ä–µ–Ω–∏—è
    load_pesticides,   # –°–ó–†
)

crops = load_crops()
fertilizers = load_fertilizers()
pesticides = load_pesticides()
```

#### –§–∏—Ç–æ—Å–∞–Ω–∏—Ç–∞—Ä–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

```python
from utils.reference_loader import (
    load_diseases,  # –ë–æ–ª–µ–∑–Ω–∏
    load_pests,     # –í—Ä–µ–¥–∏—Ç–µ–ª–∏
    load_weeds,     # –°–æ—Ä–Ω—è–∫–∏
)

diseases = load_diseases()
pests = load_pests()
weeds = load_weeds()
```

#### –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ —Ç–µ—Ö–Ω–∏–∫–∏

```python
from utils.reference_loader import (
    load_tractors,    # –¢—Ä–∞–∫—Ç–æ—Ä—ã
    load_combines,    # –ö–æ–º–±–∞–π–Ω—ã
    load_implements,  # –û—Ä—É–¥–∏—è
)

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ (–±–µ–∑ –æ—à–∏–±–æ–∫ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏)
tractors = load_tractors()    # show_error=False –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
combines = load_combines()
implements = load_implements()
```

---

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é:

```python
from utils.reference_loader import load_reference_cached

# –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ 1 —á–∞—Å
fertilizers = load_reference_cached("fertilizers.json")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
- TTL: 3600 —Å–µ–∫—É–Ω–¥ (1 —á–∞—Å)
- –•—Ä–∞–Ω–∏–ª–∏—â–µ: Streamlit cache_data

---

## üîç –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—É—Ç–∏ –ø–æ–∏—Å–∫–∞

–ú–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Ñ–∞–π–ª—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞):

1. `streamlit_app/data/` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å
2. `streamlit_app/shared/data/` - shared —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
3. `data/` - –∫–æ—Ä–Ω–µ–≤–æ–π data/
4. `shared/data/` - –∫–æ—Ä–Ω–µ–≤–æ–π shared/
5. –ò –¥—Ä—É–≥–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤:

```bash
cd streamlit_app
python test_references.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...

======================================================================
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫           –°—Ç–∞—Ç—É—Å               –ö–∞—Ç–µ–≥–æ—Ä–∏–π       –í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
======================================================================
–ö—É–ª—å—Ç—É—Ä—ã             ‚úÖ OK                 9               58
–£–¥–æ–±—Ä–µ–Ω–∏—è            ‚úÖ OK                 7               17
–°–ó–†                  ‚úÖ OK                 5               20
–ë–æ–ª–µ–∑–Ω–∏              ‚úÖ OK                 4               24
–í—Ä–µ–¥–∏—Ç–µ–ª–∏            ‚úÖ OK                 4               27
–°–æ—Ä–Ω—è–∫–∏              ‚úÖ OK                 5               24
–¢—Ä–∞–∫—Ç–æ—Ä—ã             ‚úÖ OK                 132             924
–ö–æ–º–±–∞–π–Ω—ã             ‚úÖ OK                 66              462
–û—Ä—É–¥–∏—è               ‚úÖ OK                 187             1386
======================================================================

‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ: 9/9 —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
üéâ –í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤

–í—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–π –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:

```
farm_data_system/
‚îú‚îÄ‚îÄ streamlit_app/
‚îÇ   ‚îú‚îÄ‚îÄ data/                    # ‚Üê –û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crops.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fertilizers.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pesticides.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ diseases.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pests.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ weeds.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tractors.json
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ combines.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ implements.json
‚îÇ   ‚îî‚îÄ‚îÄ shared/
‚îÇ       ‚îî‚îÄ‚îÄ data/                # ‚Üê –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
‚îÇ           ‚îî‚îÄ‚îÄ ...
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `ls streamlit_app/data/fertilizers.json`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–¥–∏—Ä–æ–≤–∫—É —Ñ–∞–π–ª–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å UTF-8)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç: `python test_references.py`

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JSON: `python -m json.tool < fertilizers.json`
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ BOM –≤ —Ñ–∞–π–ª–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å JSON (trailing commas, –∫–∞–≤—ã—á–∫–∏ –∏ —Ç.–¥.)

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç

```python
# –ë—ã–ª–æ:
import json
from pathlib import Path

# –°—Ç–∞–ª–æ:
from utils.reference_loader import load_fertilizers, load_crops
```

### –®–∞–≥ 2: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∫–æ–¥–∞

```python
# –ë—ã–ª–æ:
def load_fertilizers_reference():
    reference_path = Path(__file__).parent.parent / "data" / "fertilizers.json"
    try:
        with open(reference_path, "r", encoding="utf-8") as f:
            return json.load(f)
    except FileNotFoundError:
        st.error("–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É–¥–æ–±—Ä–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        return {}

fertilizers_ref = load_fertilizers_reference()

# –°—Ç–∞–ª–æ:
fertilizers_ref = load_fertilizers()
```

### –®–∞–≥ 3: –û—á–∏—Å—Ç–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤

–£–¥–∞–ª–∏—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã:
- `json` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤)
- `Path` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤)

---

## üìù Changelog

### Version 1.0 (2025-10-30)

- ‚úÖ –°–æ–∑–¥–∞–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 8+ –ø—É—Ç–µ–π –ø–æ–∏—Å–∫–∞
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã: Fertilizers, Pesticides, Phytosanitary, Sowing

---

## üë• –ê–≤—Ç–æ—Ä

–ê–≥—Ä–æ–î–∞–Ω–Ω—ã–µ –ö–ó - Farm Data System Team

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Internal use - Farm Data System v2.0
